(function(c){c(document).ready(function(){function f(){q.show();n.show();c("div#ccm-dashboard-result-message").remove();j.find(".responseText").remove();o.find("div.ccm-pagination").remove();d.btid=r.find(":selected").val();d.ipp=s.find(":selected").val();d.sort_by=l.val();d.sort_dir=m.val();d.ccm_paging_p=h.val();var a="?",b;for(b in d)a+=b+"="+d[b]+"&";a=a.slice(0,a.length-1);c.get(WIMB_TOOLS_URL+a,t,"json")}function t(a){a=a||{};j.find("table.ccm-results-list").remove();if("success"===a.status&&
a.response&&a.response instanceof Array&&0<a.response.length){var b;b='<table border="0" cellspacing="0" cellpadding="0" id="ccm-where-is-my-block" class="ccm-results-list"><thead><tr>';for(var i in a.response[0]){for(var d=l.val()==i?"ccm-results-list-active-sort-"+m.val():"",g=i.toString().replace(/_/g," ").replace(/-/g," ").replace(/\//g," ").split(" "),k="",e=0,f=g.length;e<f;e++)k+=g[e].charAt(0).toUpperCase()+g[e].slice(1),e+1!=f&&(k+=" ");b+='<th class="'+d+'"><a href="javascript:{};" data-sort="'+
i+'">'+k+"</a></th>"}b+="</tr></thead><tbody>";e=0;for(f=a.response.length;e<f;e++){i=a.response[e];b+='<tr class="ccm-list-record'+(0!==e%2?" ccm-list-record-alt":"")+'">';for(var h in i)d=i[h].toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),b+="<td>",b+="page_path"==h?'<a href="'+CCM_BASE_URL+i[h]+'" target="_blank">'+d+"</a>":d,b+="</td>";b+="</tr>"}b=c(b+"</tbody></table>");j.prepend(b);a.pagination&&0<a.pagination.length&&
o.prepend(a.pagination)}else if(a.alert&&0<a.alert.length&&(b=c(a.alert),b.css("display","block"),u.prepend(b)),a.message&&0<a.message.length)a=c('<h5 class="responseText">'+a.message+"</h5>"),j.prepend(a);q.hide();n.fadeTo(500,0,function(){n.css("opacity","").hide()})}var u=c("div.ccm-dashboard-page-container"),j=c("div.ccm-pane-body"),n=c("div#bodyOverlay"),o=c("div.ccm-pane-footer"),g=c("div#ccm-dashboard-content form#wimb"),q=c("img#ccm-wimb-loading"),p=g.find("select"),r=p.filter('select[name="btid"]'),
s=p.filter('select[name="ipp"]'),l=g.find('input[name="sort_by"]'),m=g.find('input[name="sort_dir"]'),h=g.find('input[name="ccm_paging_p"]'),d={};g.on("submit",function(){f();return!1});p.each(function(){c(this).on("change",function(){0<r.find(":selected").val().length&&(h.val(1),f())})});j.on("click","table#ccm-where-is-my-block th a",function(){var a=l.val(),b=m.val(),d=c(this).get(0).getAttribute("data-sort"),b="asc"==b?"desc":"asc";l.val(d);a==d&&m.val(b);f()});o.on("click","div.ccm-pagination a",
function(){var a=c(this),b=/ccm_paging_p=(\d+)/.exec(this.href);b instanceof Array&&1<b.length?a=parseInt(b[1]):"..."==a.text()?(b=parseInt(a.parent().prev().find("a:first-child").text()),a=parseInt(a.parent().next().find("a:first-child").text()),a=Math.floor((b+a)/2)):a=1;h.val(a);f();return!1})})})(jQuery);